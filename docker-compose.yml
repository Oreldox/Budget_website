services:
  # Application Next.js (avec SQLite)
  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: budget_app
    restart: unless-stopped
    environment:
      # Base de donn√©es SQLite (fichier local)
      DATABASE_URL: file:/app/data/budget.db

      # NextAuth
      NEXTAUTH_URL: ${NEXTAUTH_URL:-http://localhost:3000}
      NEXTAUTH_SECRET: ${NEXTAUTH_SECRET:-change_this_to_a_random_secret_string_min_32_chars}

      # Node environment
      NODE_ENV: production
    ports:
      - "${APP_PORT:-3000}:3000"
    networks:
      - budget_network
    volumes:
      # Persist SQLite database
      - sqlite_data:/app/data
      # Persist uploaded files if any
      - app_uploads:/app/public/uploads

volumes:
  sqlite_data:
    driver: local
  app_uploads:
    driver: local

networks:
  budget_network:
    driver: bridge
